#### Experiment: Data Used: 1.000%, Epochs: 10
**Stop Loss:** 0.300%

**Duration:** 24.01 seconds

##### Console Output:
```
Loading data for asset: eth
Subsetting data...
Total data values in intersection: 1394591
Number of data points to use: 13945
Start of subset: 2016-05-09 17:31:00+00:00
End of subset: 2016-06-07 14:48:00+00:00
Data subset shape: (13945, 44), (13945,)
Normalizing features...
Creating sequences...
Total sequences: 13915
Splitting data into training and testing sets...
Train size: (11132, 30, 40), Test size: (2783, 30, 40)
Building model...
Building Transformer model with input shape: (30, 40)
Training model...
Epoch 1/10

  1/348 [..............................] - ETA: 2:50 - loss: 182.6869
 13/348 [>.............................] - ETA: 1s - loss: 127.3470  
 28/348 [=>............................] - ETA: 1s - loss: 87.2753 
 39/348 [==>...........................] - ETA: 1s - loss: 67.8781
 53/348 [===>..........................] - ETA: 1s - loss: 51.0954
 66/348 [====>.........................] - ETA: 1s - loss: 41.3258
 80/348 [=====>........................] - ETA: 1s - loss: 34.3510
 93/348 [=======>......................] - ETA: 1s - loss: 29.6986
108/348 [========>.....................] - ETA: 0s - loss: 25.7107
110/348 [========>.....................] - ETA: 3s - loss: 25.2592
122/348 [=========>....................] - ETA: 3s - loss: 22.8507
135/348 [==========>...................] - ETA: 2s - loss: 20.7202
148/348 [===========>..................] - ETA: 2s - loss: 18.9507
161/348 [============>.................] - ETA: 2s - loss: 17.4611
175/348 [==============>...............] - ETA: 1s - loss: 16.0948
189/348 [===============>..............] - ETA: 1s - loss: 14.9245
202/348 [================>.............] - ETA: 1s - loss: 13.9821
216/348 [=================>............] - ETA: 1s - loss: 13.0917
229/348 [==================>...........] - ETA: 1s - loss: 12.3607
242/348 [===================>..........] - ETA: 0s - loss: 11.7068
255/348 [====================>.........] - ETA: 0s - loss: 11.1212
269/348 [======================>.......] - ETA: 0s - loss: 10.5524
283/348 [=======================>......] - ETA: 0s - loss: 10.0390
297/348 [========================>.....] - ETA: 0s - loss: 9.5741 
313/348 [=========================>....] - ETA: 0s - loss: 9.0932
326/348 [===========================>..] - ETA: 0s - loss: 8.7359
340/348 [============================>.] - ETA: 0s - loss: 8.3837
Epoch 1: val_loss improved from inf to 0.83428, saving model to models\transformer_eth_model_1pct.h5

348/348 [==============================] - 5s 12ms/step - loss: 8.1971 - val_loss: 0.8343
Epoch 2/10

  1/348 [..............................] - ETA: 1s - loss: 0.1265
 13/348 [>.............................] - ETA: 1s - loss: 0.1370
 26/348 [=>............................] - ETA: 1s - loss: 0.1271
 39/348 [==>...........................] - ETA: 1s - loss: 0.1322
 52/348 [===>..........................] - ETA: 1s - loss: 0.1313
 65/348 [====>.........................] - ETA: 1s - loss: 0.1298
 78/348 [=====>........................] - ETA: 1s - loss: 0.1259
 91/348 [======>.......................] - ETA: 1s - loss: 0.1255
102/348 [=======>......................] - ETA: 1s - loss: 0.1249
114/348 [========>.....................] - ETA: 0s - loss: 0.1236
127/348 [=========>....................] - ETA: 0s - loss: 0.1229
140/348 [===========>..................] - ETA: 0s - loss: 0.1247
152/348 [============>.................] - ETA: 0s - loss: 0.1240
165/348 [=============>................] - ETA: 0s - loss: 0.1237
178/348 [==============>...............] - ETA: 0s - loss: 0.1239
191/348 [===============>..............] - ETA: 0s - loss: 0.1237
194/348 [===============>..............] - ETA: 1s - loss: 0.1237
205/348 [================>.............] - ETA: 1s - loss: 0.1218
217/348 [=================>............] - ETA: 1s - loss: 0.1204
230/348 [==================>...........] - ETA: 1s - loss: 0.1198
243/348 [===================>..........] - ETA: 0s - loss: 0.1190
256/348 [=====================>........] - ETA: 0s - loss: 0.1181
268/348 [======================>.......] - ETA: 0s - loss: 0.1175
281/348 [=======================>......] - ETA: 0s - loss: 0.1163
294/348 [========================>.....] - ETA: 0s - loss: 0.1155
306/348 [=========================>....] - ETA: 0s - loss: 0.1142
318/348 [==========================>...] - ETA: 0s - loss: 0.1132
331/348 [===========================>..] - ETA: 0s - loss: 0.1121
343/348 [============================>.] - ETA: 0s - loss: 0.1110
Epoch 2: val_loss did not improve from 0.83428

348/348 [==============================] - 3s 8ms/step - loss: 0.1106 - val_loss: 1.1597
Epoch 3/10

  1/348 [..............................] - ETA: 1s - loss: 0.0821
 13/348 [>.............................] - ETA: 1s - loss: 0.0760
 26/348 [=>............................] - ETA: 1s - loss: 0.0822
 39/348 [==>...........................] - ETA: 1s - loss: 0.0860
 41/348 [==>...........................] - ETA: 10s - loss: 0.0859
 52/348 [===>..........................] - ETA: 8s - loss: 0.0842 
 64/348 [====>.........................] - ETA: 6s - loss: 0.0824
 76/348 [=====>........................] - ETA: 5s - loss: 0.0834
 88/348 [======>.......................] - ETA: 4s - loss: 0.0833
101/348 [=======>......................] - ETA: 3s - loss: 0.0834
113/348 [========>.....................] - ETA: 3s - loss: 0.0824
126/348 [=========>....................] - ETA: 3s - loss: 0.0821
139/348 [==========>...................] - ETA: 2s - loss: 0.0817
151/348 [============>.................] - ETA: 2s - loss: 0.0806
164/348 [=============>................] - ETA: 2s - loss: 0.0798
177/348 [==============>...............] - ETA: 1s - loss: 0.0790
190/348 [===============>..............] - ETA: 1s - loss: 0.0786
203/348 [================>.............] - ETA: 1s - loss: 0.0778
217/348 [=================>............] - ETA: 1s - loss: 0.0768
231/348 [==================>...........] - ETA: 1s - loss: 0.0768
244/348 [====================>.........] - ETA: 0s - loss: 0.0769
258/348 [=====================>........] - ETA: 0s - loss: 0.0760
271/348 [======================>.......] - ETA: 0s - loss: 0.0754
284/348 [=======================>......] - ETA: 0s - loss: 0.0748
292/348 [========================>.....] - ETA: 0s - loss: 0.0744
305/348 [=========================>....] - ETA: 0s - loss: 0.0737
318/348 [==========================>...] - ETA: 0s - loss: 0.0732
331/348 [===========================>..] - ETA: 0s - loss: 0.0726
344/348 [============================>.] - ETA: 0s - loss: 0.0720
Epoch 3: val_loss did not improve from 0.83428

348/348 [==============================] - 4s 11ms/step - loss: 0.0717 - val_loss: 1.3388
Epoch 4/10

  1/348 [..............................] - ETA: 1s - loss: 0.0637
 13/348 [>.............................] - ETA: 1s - loss: 0.0594
 26/348 [=>............................] - ETA: 1s - loss: 0.0609
 39/348 [==>...........................] - ETA: 1s - loss: 0.0601
 53/348 [===>..........................] - ETA: 1s - loss: 0.0610
 67/348 [====>.........................] - ETA: 1s - loss: 0.0611
 80/348 [=====>........................] - ETA: 1s - loss: 0.0610
 93/348 [=======>......................] - ETA: 0s - loss: 0.0604
106/348 [========>.....................] - ETA: 0s - loss: 0.0602
120/348 [=========>....................] - ETA: 0s - loss: 0.0588
133/348 [==========>...................] - ETA: 0s - loss: 0.0586
146/348 [===========>..................] - ETA: 0s - loss: 0.0582
155/348 [============>.................] - ETA: 2s - loss: 0.0577
165/348 [=============>................] - ETA: 2s - loss: 0.0578
176/348 [==============>...............] - ETA: 1s - loss: 0.0577
189/348 [===============>..............] - ETA: 1s - loss: 0.0576
201/348 [================>.............] - ETA: 1s - loss: 0.0576
214/348 [=================>............] - ETA: 1s - loss: 0.0587
227/348 [==================>...........] - ETA: 1s - loss: 0.0588
240/348 [===================>..........] - ETA: 0s - loss: 0.0587
253/348 [====================>.........] - ETA: 0s - loss: 0.0598
266/348 [=====================>........] - ETA: 0s - loss: 0.0604
279/348 [=======================>......] - ETA: 0s - loss: 0.0603
292/348 [========================>.....] - ETA: 0s - loss: 0.0597
305/348 [=========================>....] - ETA: 0s - loss: 0.0594
319/348 [==========================>...] - ETA: 0s - loss: 0.0587
332/348 [===========================>..] - ETA: 0s - loss: 0.0585
345/348 [============================>.] - ETA: 0s - loss: 0.0581
Epoch 4: val_loss did not improve from 0.83428

348/348 [==============================] - 3s 8ms/step - loss: 0.0580 - val_loss: 1.2870
Epoch 5/10

  1/348 [..............................] - ETA: 1s - loss: 0.0461
 14/348 [>.............................] - ETA: 32s - loss: 0.0455
 27/348 [=>............................] - ETA: 16s - loss: 0.0489
 40/348 [==>...........................] - ETA: 10s - loss: 0.0543
 53/348 [===>..........................] - ETA: 7s - loss: 0.0552 
 66/348 [====>.........................] - ETA: 6s - loss: 0.0538
 78/348 [=====>........................] - ETA: 5s - loss: 0.0537
 91/348 [======>.......................] - ETA: 4s - loss: 0.0528
104/348 [=======>......................] - ETA: 3s - loss: 0.0519
117/348 [=========>....................] - ETA: 3s - loss: 0.0512
130/348 [==========>...................] - ETA: 2s - loss: 0.0509
143/348 [===========>..................] - ETA: 2s - loss: 0.0507
154/348 [============>.................] - ETA: 2s - loss: 0.0507
167/348 [=============>................] - ETA: 2s - loss: 0.0500
180/348 [==============>...............] - ETA: 1s - loss: 0.0499
193/348 [===============>..............] - ETA: 1s - loss: 0.0494
206/348 [================>.............] - ETA: 1s - loss: 0.0491
218/348 [=================>............] - ETA: 1s - loss: 0.0489
231/348 [==================>...........] - ETA: 1s - loss: 0.0483
244/348 [====================>.........] - ETA: 0s - loss: 0.0479
257/348 [=====================>........] - ETA: 0s - loss: 0.0478
264/348 [=====================>........] - ETA: 1s - loss: 0.0477
276/348 [======================>.......] - ETA: 0s - loss: 0.0477
289/348 [=======================>......] - ETA: 0s - loss: 0.0473
302/348 [=========================>....] - ETA: 0s - loss: 0.0472
315/348 [==========================>...] - ETA: 0s - loss: 0.0470
328/348 [===========================>..] - ETA: 0s - loss: 0.0471
341/348 [============================>.] - ETA: 0s - loss: 0.0468
Epoch 5: val_loss did not improve from 0.83428

348/348 [==============================] - 4s 12ms/step - loss: 0.0468 - val_loss: 1.7970
Epoch 6/10

  1/348 [..............................] - ETA: 1s - loss: 0.0522
 14/348 [>.............................] - ETA: 1s - loss: 0.0380
 26/348 [=>............................] - ETA: 1s - loss: 0.0412
 41/348 [==>...........................] - ETA: 1s - loss: 0.0419
 55/348 [===>..........................] - ETA: 1s - loss: 0.0443
 70/348 [=====>........................] - ETA: 1s - loss: 0.0447
 83/348 [======>.......................] - ETA: 1s - loss: 0.0452
 97/348 [=======>......................] - ETA: 0s - loss: 0.0436
111/348 [========>.....................] - ETA: 0s - loss: 0.0432
126/348 [=========>....................] - ETA: 0s - loss: 0.0431
131/348 [==========>...................] - ETA: 2s - loss: 0.0430
144/348 [===========>..................] - ETA: 2s - loss: 0.0431
157/348 [============>.................] - ETA: 2s - loss: 0.0430
170/348 [=============>................] - ETA: 1s - loss: 0.0441
183/348 [==============>...............] - ETA: 1s - loss: 0.0449
196/348 [===============>..............] - ETA: 1s - loss: 0.0451
209/348 [=================>............] - ETA: 1s - loss: 0.0449
222/348 [==================>...........] - ETA: 1s - loss: 0.0450
235/348 [===================>..........] - ETA: 1s - loss: 0.0450
248/348 [====================>.........] - ETA: 0s - loss: 0.0448
262/348 [=====================>........] - ETA: 0s - loss: 0.0443
276/348 [======================>.......] - ETA: 0s - loss: 0.0440
289/348 [=======================>......] - ETA: 0s - loss: 0.0437
302/348 [=========================>....] - ETA: 0s - loss: 0.0434
316/348 [==========================>...] - ETA: 0s - loss: 0.0432
329/348 [===========================>..] - ETA: 0s - loss: 0.0430
343/348 [============================>.] - ETA: 0s - loss: 0.0428
Epoch 6: val_loss did not improve from 0.83428
Restoring model weights from the end of the best epoch: 1.

348/348 [==============================] - 3s 8ms/step - loss: 0.0426 - val_loss: 1.6282
Epoch 6: early stopping
Plotting training loss...
Loss curve saved to: plots\loss_curve_transformer_eth_1pct.png
Generating predictions on test set...

 1/87 [..............................] - ETA: 5s
44/87 [==============>...............] - ETA: 0s
79/87 [==========================>...] - ETA: 0s
87/87 [==============================] - 0s 1ms/step
Predictions shape: (2783, 1)
Plotting predictions and saving comparison CSV...
Prediction plot saved to: plots\prediction_plot_transformer_eth_1pct.png
Comparison CSV saved to: model-result-data\transformer_eth_1pct_comparison.csv
Printing evaluation metrics...
1.0% | acc 0.0503  prec 0.0336  rec 0.3079  f1 0.0605  mse 0.8343  rmse 0.9134  mae 0.8916
Saving model and scaler...
Model saved to: models\transformer_eth_model_1pct.h5
Scaler saved to: models\transformer_eth_scaler_1pct.pkl
Training and prediction complete.
Signal distribution:
Signal
 1    2780
-1       3
Name: count, dtype: int64
Setting up Backtest object...
Running backtest engine...
Found 2780 +1 signals and 3 -1 signals in the data.
Start                                     0.0
End                                    2782.0
Duration                               2782.0
Exposure Time [%]                    61.40855
Equity Final [$]                 131731.79568
Equity Peak [$]                  134439.23568
Return [%]                            31.7318
Buy & Hold Return [%]                -0.70373
Return (Ann.) [%]                         0.0
Volatility (Ann.) [%]                     NaN
Sharpe Ratio                              NaN
Sortino Ratio                             NaN
Calmar Ratio                              0.0
Alpha [%]                            31.93567
Beta                                   0.2897
Max. Drawdown [%]                     -5.1964
Avg. Drawdown [%]                    -2.22553
Max. Drawdown Duration                 1070.0
Avg. Drawdown Duration                  333.0
# Trades                                 14.0
Win Rate [%]                         14.28571
Best Trade [%]                       18.53767
Worst Trade [%]                      -0.63559
Avg. Trade [%]                        1.76292
Max. Trade Duration                    1245.0
Avg. Trade Duration                 121.21429
Profit Factor                         7.02204
Expectancy [%]                        1.91032
SQN                                   1.21172
Kelly Criterion                       0.12132
_strategy                 MLStrategy(stop_...
_equity_curve                         Equi...
_trades                       Size  EntryB...
dtype: object

Trade Details:
Number of trades:       14
Number of closed trades:14
Number of open trades:  0
Saving backtest plot to HTML...
Backtest stats saved to: results\transformer_eth_1pct_0_3stloss\backtest_stats.csv
Full pipeline complete.

```
##### Training Loss Plot:
![Training Loss Plot](../../plots/loss_curve_transformer_eth_1pct.png)

##### Prediction Plot:
![Prediction Plot](../../plots/prediction_plot_transformer_eth_1pct.png)

##### Metrics CSV:
[View CSV](../../model-result-data/eth_transformer_1pct_metrics.csv)

##### Backtest Interactive Chart:
<iframe src="../../results/transformer_eth_1pct_0_3stloss/backtest_plot.html" width="100%" height="600px" frameborder="0"></iframe>
If the iframe does not display, please [click here to view the HTML](../../results/transformer_eth_1pct_0_3stloss/backtest_plot.html).

##### Backtest Stats:
[View CSV](../../results/transformer_eth_1pct_0_3stloss/backtest_stats.csv)

##### Saved Model and Scaler:
- **Model:** [View Model](../../models/transformer_eth_model_1pct.h5)
- **Scaler:** [View Scaler](../../models/transformer_eth_scaler_1pct.pkl)


---

